<!DOCTYPE HTML>
<html lang="en-US">

<head>
    <meta charset="UTF-8">
    <title>walk.html</title>
    <script type="text/javascript" src="simpleGame.js"></script>
    <script type="text/javascript" src="map.js"></script>
    <style>
        body,
        html {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: black;
        }

        canvas {
            display: block;
        }
    </style>
    <script type="text/javascript">
        var game;
        var background;
        var character;
        var wallBushes = []; // ‡πÄ‡∏Å‡πá‡∏ö Sprite ‡∏Ç‡∏≠‡∏á‡∏û‡∏∏‡πà‡∏°‡πÑ‡∏°‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

        function init() {
            let screenWidth = window.innerWidth;
            let screenHeight = window.innerHeight;

            game = new Scene();
            game.setSize(screenWidth, screenHeight); // ‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏≠

            background = new Sprite(game, "grass.png", 1632, 966);
            background.setSpeed(0, 0);
            background.setPosition(screenWidth / 2, screenHeight / 2);

            character = new Sprite(game, "Slime1_Walk_body.png", 512, 256);
            character.loadAnimation(512, 256, 64, 64);
            character.generateAnimationCycles();
            character.renameCycles(["down", "up", "left", "right"]);
            character.setAnimationSpeed(500);

            character.setPosition(screenWidth / 2, screenHeight / 2);
            character.setSpeed(0);
            character.pauseAnimation();
            character.setCurrentCycle("down");

            // üî• ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏û‡∏∏‡πà‡∏°‡πÑ‡∏°‡πâ
            createMaze();

            game.start();
        }



        function update() {
            game.clear();
            checkKeys();

            background.update(); // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á
            character.update();  // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£

            // üî• ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏û‡∏∏‡πà‡∏°‡πÑ‡∏°‡πâ‡∏Ñ‡∏á‡∏ó‡∏µ‡πà ‡πÑ‡∏°‡πà‡∏Ç‡∏¢‡∏±‡∏ö
            for (let bush of wallBushes) {
                bush.update();
                bush.setSpeed(0); // ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà
            }
        }

        function checkKeys() {
            if (keysDown[K_LEFT]) {
                character.setSpeed(5);
                character.playAnimation();
                character.setMoveAngle(270);
                character.setCurrentCycle("left");
            } else if (keysDown[K_RIGHT]) {
                character.setSpeed(5);
                character.playAnimation();
                character.setMoveAngle(90);
                character.setCurrentCycle("right");
            } else if (keysDown[K_UP]) {
                character.setSpeed(5);
                character.playAnimation();
                character.setMoveAngle(0);
                character.setCurrentCycle("up");
            } else if (keysDown[K_DOWN]) {
                character.setSpeed(5);
                character.playAnimation();
                character.setMoveAngle(180);
                character.setCurrentCycle("down");
            } else if (keysDown[K_SPACE]) {
                character.setSpeed(0);
                character.pauseAnimation();
                character.setCurrentCycle("down");
            } else {
                character.setSpeed(0);
            }
        }

        window.onresize = function () {
            let newWidth = window.innerWidth;
            let newHeight = window.innerHeight;
            game.setSize(newWidth, newHeight);
            background.setPosition(newWidth / 2, newHeight / 2);
            character.setPosition(newWidth / 2, newHeight / 2);
        };

    </script>
</head>

<body onload="init()">
</body>

</html>