<!DOCTYPE HTML>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <title>walk.html</title>
    <script type="text/javascript" src="simpleGame.js"></script>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: black;
        }
        canvas {
            display: block;
        }
    </style>
    <script type="text/javascript">
        var game;
        var background;
        var character;
        var wallBushes = []; // Array ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏û‡∏∏‡πà‡∏°‡πÑ‡∏°‡πâ‡∏´‡∏•‡∏≤‡∏¢‡∏≠‡∏±‡∏ô
        

        function init(){
            let screenWidth = window.innerWidth;
            let screenHeight = window.innerHeight;

            game = new Scene();
            game.setSize(screenWidth, screenHeight);

            background = new Sprite(game, "grass.png", 1632, 966);
            background.setSpeed(0, 0);
            background.setPosition(screenWidth / 2, screenHeight / 2);

            character = new Sprite(game, "Slime1_Walk_body.png", 512, 256);
            character.loadAnimation(512, 256, 64, 64);
            character.generateAnimationCycles();
            character.renameCycles(["down", "up", "left", "right"]);
            character.setAnimationSpeed(500);
            character.setPosition(screenWidth / 2, 15);
            character.setSpeed(0);
            character.pauseAnimation();
            character.setCurrentCycle("down");

            // ‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡∏û‡∏∏‡πà‡∏°‡πÑ‡∏°‡πâ‡∏£‡∏≠‡∏ö‡∏Ç‡∏≠‡∏ö‡∏â‡∏≤‡∏Å
            createWallBushes();

            game.start();
        }

        function createWallBushes(){
            let bushWidth = 163; // ‡∏Ç‡∏ô‡∏≤‡∏î‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏û‡∏∏‡πà‡∏°‡πÑ‡∏°‡πâ (‡∏Å‡∏ß‡πâ‡∏≤‡∏á)
            let bushHeight = 153; // ‡∏Ç‡∏ô‡∏≤‡∏î‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏û‡∏∏‡πà‡∏°‡πÑ‡∏°‡πâ (‡∏™‡∏π‡∏á)
            let cols = Math.ceil(1632 / bushWidth); // ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á
            let rows = Math.ceil(966 / bushHeight); // ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ñ‡∏ß‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á

            // üîπ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏û‡∏∏‡πà‡∏°‡πÑ‡∏°‡πâ‡∏ã‡πâ‡∏≤‡∏¢-‡∏Ç‡∏ß‡∏≤
            for (let i = 0; i < rows; i++) {
                let y = i * bushHeight + (bushHeight / 2);

                let leftBush = new Sprite(game, "SpriteWallBush.png", 979, 153);
                leftBush.loadAnimation(979, 153, 163, 153);
                leftBush.generateAnimationCycles(SINGLE_ROW, 6);
                leftBush.setAnimationSpeed(700);
                leftBush.setPosition(bushWidth / 2, y);
                leftBush.playAnimation();
                wallBushes.push(leftBush);

                let rightBush = new Sprite(game, "SpriteWallBush.png", 979, 153);
                rightBush.loadAnimation(979, 153, 163, 153);
                rightBush.generateAnimationCycles(SINGLE_ROW, 6);
                rightBush.setAnimationSpeed(700);
                rightBush.setPosition(1632 - (bushWidth / 2), y);
                rightBush.playAnimation();
                wallBushes.push(rightBush);
            }
        }

        function update(){
            game.clear();
            checkKeys();
            background.update();
            character.update();

            // ‚úÖ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏û‡∏∏‡πà‡∏°‡πÑ‡∏°‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
            for (let bush of wallBushes) {
                bush.update();
            }
        }

        function checkKeys(){
            if (keysDown[K_LEFT]){
                character.setSpeed(5);
                character.playAnimation();
                character.setMoveAngle(270);
                character.setCurrentCycle("left");
            } else if (keysDown[K_RIGHT]){
                character.setSpeed(5);
                character.playAnimation();
                character.setMoveAngle(90);
                character.setCurrentCycle("right");
            } else if (keysDown[K_UP]){
                character.setSpeed(5);
                character.playAnimation();
                character.setMoveAngle(0);
                character.setCurrentCycle("up");
            } else if (keysDown[K_DOWN]){
                character.setSpeed(5);
                character.playAnimation();
                character.setMoveAngle(180);
                character.setCurrentCycle("down");
            } else if (keysDown[K_SPACE]){
                character.setSpeed(0);
                character.pauseAnimation();
                character.setCurrentCycle("down");
            } else {
                character.setSpeed(0);
            }
        }

        /* window.onresize = function() {
            let newWidth = window.innerWidth;
            let newHeight = window.innerHeight;
            game.setSize(newWidth, newHeight);
            background.setPosition(newWidth / 2, newHeight / 2);
            character.setPosition(newWidth / 2, newHeight / 2);
        }; */

    </script>
</head>
<body onload="init()">
</body>
</html>
