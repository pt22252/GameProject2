<!DOCTYPE HTML>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <title>SlimeCH1</title>
    <script type="text/javascript" src="simpleGame.js"></script>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: black;
        }
        canvas {
            display: block;
        }
    </style>
    <script type="text/javascript">
        var game;
        var background;
        var character;
        var wallBushes = [];
        var berryBush;

        function init() {
            game = new Scene();
            game.setSize(window.innerWidth, window.innerHeight);

            // à¸žà¸·à¹‰à¸™à¸«à¸¥à¸±à¸‡
            background = new Sprite(game, "BG2.png", window.innerWidth, window.innerHeight);
            background.setSpeed(0, 0);
            background.setPosition(window.innerWidth / 2, window.innerHeight / 2);

            // à¸•à¸±à¸§à¸¥à¸°à¸„à¸£
            character = new Sprite(game, "Sprite_Slime_Big.png", 79, 79);
            character.loadAnimation(634, 317, 79, 79);
            character.generateAnimationCycles();
            character.renameCycles(["down", "up", "left", "right"]);
            character.setAnimationSpeed(500);
            character.setPosition(80, 80);
            character.setSpeed(0);
            character.pauseAnimation();
            character.setCurrentCycle("down");

            // à¸ªà¸£à¹‰à¸²à¸‡à¸žà¸¸à¹ˆà¸¡à¹„à¸¡à¹‰
            createWallBushes();
            game.start();

            // à¸ªà¸£à¹‰à¸²à¸‡à¸žà¸¸à¹ˆà¸¡à¹„à¸¡à¹‰
            createBerryBushes();
            game.start();
        }

        function createWallBushes() {
            let bushWidth = 45;
            let bushHeight = 45;

            // à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡à¸‚à¸­à¸‡à¸žà¸¸à¹ˆà¸¡à¹„à¸¡à¹‰
            let bushPositions = [
                { x: 20, y: 20 }, { x: 60, y: 20 }, { x: 100, y: 20 }, { x: 140, y: 20 }, { x: 180, y: 20 }, { x: 220, y: 20 }, { x: 260, y: 20 }, { x: 300, y: 20 }, { x: 340, y: 20 }, { x: 380, y: 20 }, { x: 420, y: 20 }, { x: 460, y: 20 }, { x: 500, y: 20 }, { x: 540, y: 20 }, { x: 580, y: 20 }, { x: 620, y: 20 }, { x: 660, y: 20 }, { x: 700, y: 20 }, { x: 740, y: 20 }, { x: 780, y: 20 }, { x: 820, y: 20 }, { x: 860, y: 20 }, { x: 900, y: 20 }, { x: 940, y: 20 }, { x: 980, y: 20 }, { x: 1020, y: 20 }, { x: 1060, y: 20 }, { x: 1100, y: 20 }, { x: 1120, y: 20 }, // à¸à¸£à¸­à¸šà¸šà¸™
                { x: 20, y: 60 }, { x: 20, y: 100 }, { x: 20, y: 140 }, { x: 20, y: 180 }, { x: 20, y: 220 }, { x: 20, y: 260 }, { x: 20, y: 300 }, { x:20, y: 340 }, { x: 20, y: 380 }, { x: 20, y: 420 }, { x: 20, y: 460 }, { x: 20, y: 500 }, { x: 20, y: 540 }, { x: 20, y: 580 }, // à¸à¸£à¸­à¸šà¸‹à¹‰à¸²à¸¢
                { x: 1120, y: 60 }, { x: 1120, y: 100 }, { x: 1120, y: 140 }, { x: 1120, y: 180 }, { x: 1120, y: 220 }, { x: 1120, y: 260 }, { x: 1120, y: 300 }, { x: 1120, y: 340 }, { x: 1120, y: 380 }, { x: 1120, y: 420 }, { x: 1120, y: 460 }, { x: 1120, y: 500 }, { x: 1120, y: 540 }, { x: 1120, y: 580 }, // à¸à¸£à¸­à¸šà¸‚à¸§à¸²
                { x: 20, y: 620 }, { x: 60, y: 620 }, { x: 100, y: 620 }, { x: 140, y: 620 }, { x: 180, y: 620 }, { x: 220, y: 620 }, { x: 260, y: 620 }, { x: 300, y: 620 }, { x: 340, y: 620 }, { x: 380, y: 620 }, { x: 420, y: 620 }, { x: 460, y: 620 }, { x: 500, y: 620 }, { x: 540, y: 620 }, { x: 580, y: 620 }, { x: 620, y: 620 }, { x: 660, y: 620 }, { x: 700, y: 620 }, { x: 740, y: 620 }, { x: 780, y: 620 }, { x: 820, y: 620 }, { x: 860, y: 620 }, { x: 900, y: 620 }, { x: 940, y: 620 }, { x: 980, y: 620 }, { x: 1020, y: 620 }, { x: 1060, y: 620 }, { x: 1100, y: 620 }, { x: 1120, y: 620 }, // à¸à¸£à¸­à¸šà¸¥à¹ˆà¸²à¸‡
                { x: 60, y: 140 }, { x: 100, y: 140 }, { x: 140, y: 140 }, { x: 180, y: 140 }, { x: 220, y: 140 }, { x: 260, y: 140 }, { x: 300, y: 140 }, //à¸šà¸™à¸‹à¹‰à¸²à¸¢à¸ªà¸¸à¸”
                { x: 150, y: 300 }, { x: 190, y: 300 }, { x: 230, y: 300 }, { x: 270, y: 300 }, { x: 310, y: 300 },  //à¸šà¸™à¸‹à¹‰à¸²à¸¢à¸ªà¸­à¸‡
                { x: 310, y: 340 }, { x: 310, y: 380 }, { x: 310, y: 420 }, { x: 310, y: 460 }, { x: 310, y: 500 }, { x: 310, y: 540 }, { x: 310, y: 580 }, { x: 310, y: 620 }, //à¸•à¹ˆà¸­à¸ˆà¸²à¸à¸šà¸™à¸‹à¹‰à¸²à¸¢à¸ªà¸­à¸‡
                { x: 60, y: 460 }, { x: 100, y: 460 }, { x: 140, y: 460 }, { x: 180, y: 460 }, //à¸Šà¹‰à¸²à¸¢à¸¥à¹ˆà¸²à¸‡
               // { x: 410, y: 20 }, { x: 410, y: 60 }, { x: 410, y: 100 }, { x: 410, y: 140 }, { x: 410, y: 180 }, { x: 410, y: 220 }, { x: 410, y: 260 }, //à¸‚à¸µà¸”à¸•à¸±à¹‰à¸‡à¸à¸¥à¸²à¸‡
                { x: 450, y: 260 }, { x: 490, y: 260 }, { x: 530, y: 260 }, { x: 570, y: 260 }, { x: 610, y: 260 }, { x: 650, y: 260 }, { x: 690, y: 260 }, { x: 730, y: 260 }, { x: 770, y: 260 },
                { x: 770, y: 300 }, { x: 770, y: 340 }, { x: 770, y: 380 }, 
              //  { x: 730, y: 380 }, { x: 690, y: 380 }, { x: 650, y: 380 }, { x: 610, y: 380 }, { x: 570, y: 380 }, { x: 530, y: 380 }, 
              //  { x: 530, y: 420 }, { x: 530, y: 460 }, { x: 530, y: 500 }, 
                { x: 530, y: 380 }, { x: 530, y: 420 }, { x: 530, y: 460 }, { x: 530, y: 500 }, 
                { x: 690, y: 500 }, { x: 690, y: 540 }, { x: 690, y: 580 }, { x: 690, y: 620 },
                { x: 550, y: 140 }, { x: 590, y: 140 }, { x: 630, y: 140 }, { x: 670, y: 140 }, { x: 710, y: 140 }, { x: 750, y: 140 }, { x: 790, y: 140 }, { x: 830, y: 140 }, { x: 870, y: 140 }, { x: 910, y: 140 }, { x: 950, y: 140 },
                { x: 950, y: 180 }, { x: 950, y: 220 }, { x: 950, y: 260 }, { x: 950, y: 300 }, { x: 950, y: 340 }, { x: 950, y: 380 }, { x: 950, y: 420 }, { x: 950, y: 460 }, { x: 950, y: 500 }, { x: 950, y: 540 }, { x: 950, y: 580 }, { x: 950, y: 620 }, 
            
            ];

            // à¸ªà¸£à¹‰à¸²à¸‡à¸žà¸¸à¹ˆà¸¡à¹„à¸¡à¹‰à¹ƒà¸™à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡à¸—à¸µà¹ˆà¸à¸³à¸«à¸™à¸”
            for (let pos of bushPositions) {
                let bush = new Sprite(game, "Cactus2.png", bushWidth, bushHeight);
                bush.setSpeed(0);  // ðŸš« à¸«à¸¢à¸¸à¸”à¸žà¸¸à¹ˆà¸¡à¹„à¸¡à¹‰à¹„à¸¡à¹ˆà¹ƒà¸«à¹‰à¸‚à¸¢à¸±à¸š
                bush.setPosition(pos.x, pos.y);
                wallBushes.push(bush);
            }
        }

        function checkCollision() {
            let charLeft = character.x - character.width / 2;
            let charRight = character.x + character.width / 2;
            let charTop = character.y - character.height / 2;
            let charBottom = character.y + character.height / 2;

            for (let bush of wallBushes) {
                // à¸¥à¸”à¸‚à¸™à¸²à¸”à¸‚à¸­à¸‡à¸à¸£à¸­à¸šà¸à¸²à¸£à¸Šà¸™à¸‚à¸­à¸‡à¸žà¸¸à¹ˆà¸¡à¹„à¸¡à¹‰
                let bushPadding = 10;  // à¹€à¸žà¸´à¹ˆà¸¡à¸„à¹ˆà¸²à¸•à¸£à¸‡à¸™à¸µà¹‰à¹€à¸žà¸·à¹ˆà¸­à¹€à¸¥à¹‡à¸à¸¥à¸‡à¸«à¸£à¸·à¸­à¸‚à¸¢à¸²à¸¢à¸à¸£à¸­à¸š
                let bushLeft = bush.x - bush.width / 2 + bushPadding;
                let bushRight = bush.x + bush.width / 2 - bushPadding;
                let bushTop = bush.y - bush.height / 2 + bushPadding;
                let bushBottom = bush.y + bush.height / 2 - bushPadding;

                if (charRight > bushLeft && charLeft < bushRight && charBottom > bushTop && charTop < bushBottom) {
                    // à¸–à¹‰à¸²à¸Šà¸™ à¹ƒà¸«à¹‰à¸¢à¹‰à¸­à¸™à¸à¸¥à¸±à¸šà¹„à¸›à¸—à¸µà¹ˆà¸•à¸³à¹à¸«à¸™à¹ˆà¸‡à¸à¹ˆà¸­à¸™à¸«à¸™à¹‰à¸²
                    character.setPosition(character.lastX, character.lastY);
                    character.setSpeed(0);
                    return;
                }
            }
        }

        function createBerryBushes() {
            let bushWidth = 40;
            let bushHeight = 40;

            // à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡à¸‚à¸­à¸‡à¸žà¸¸à¹ˆà¸¡à¹„à¸¡à¹‰
            let bushPositions = [
                { x: 100, y: 550 }, { x: 430, y: 550 }, { x: 430, y: 100 }, { x: 1030, y: 100 }, { x: 1030, y: 5500 }
            ];

            // à¸ªà¸£à¹‰à¸²à¸‡à¸žà¸¸à¹ˆà¸¡à¹„à¸¡à¹‰à¹ƒà¸™à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡à¸—à¸µà¹ˆà¸à¸³à¸«à¸™à¸”
            for (let pos of bushPositions) {
                let bush = new Sprite(game, "berry.png", bushWidth, bushHeight);
                bush.setSpeed(0);  // ðŸš« à¸«à¸¢à¸¸à¸”à¸žà¸¸à¹ˆà¸¡à¹„à¸¡à¹‰à¹„à¸¡à¹ˆà¹ƒà¸«à¹‰à¸‚à¸¢à¸±à¸š
                bush.setPosition(pos.x, pos.y);
                wallBushes.push(bush);
            }
        }


        function update() {
            game.clear();
            checkKeys();        // à¸£à¸­à¹ƒà¸«à¹‰à¹€à¸£à¸²à¸à¸”à¸›à¸¸à¹ˆà¸¡à¸„à¸§à¸šà¸„à¸¸à¸¡
            background.update();
            character.update(); // à¸­à¸±à¸›à¹€à¸”à¸•à¸•à¸±à¸§à¸¥à¸°à¸„à¸£
            checkCollision();   // à¸•à¸£à¸§à¸ˆà¸Šà¸™à¸à¸±à¸šà¸žà¸¸à¹ˆà¸¡à¹„à¸¡à¹‰

            // à¸­à¸±à¸›à¹€à¸”à¸•à¸žà¸¸à¹ˆà¸¡à¹„à¸¡à¹‰à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”
            for (let bush of wallBushes) {
                bush.update();
            }
        }

        function checkKeys() {
            // à¸šà¸±à¸™à¸—à¸¶à¸à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡à¸à¹ˆà¸­à¸™à¸à¸²à¸£à¹€à¸„à¸¥à¸·à¹ˆà¸­à¸™à¸—à¸µà¹ˆ (à¹ƒà¸Šà¹‰à¸ªà¸³à¸«à¸£à¸±à¸šà¸•à¸£à¸§à¸ˆà¸Šà¸™)
            character.lastX = character.x;
            character.lastY = character.y;

            let moving = false; // à¹€à¸Šà¹‡à¸„à¸§à¹ˆà¸²à¸à¸³à¸¥à¸±à¸‡à¹€à¸”à¸´à¸™à¸­à¸¢à¸¹à¹ˆà¹„à¸«à¸¡

            if (keysDown[K_LEFT]) {
                character.setSpeed(10);
                character.setMoveAngle(270); // à¹„à¸›à¸‹à¹‰à¸²à¸¢
                character.setCurrentCycle("left");
                moving = true;
            } 
            if (keysDown[K_RIGHT]) {
                character.setSpeed(10);
                character.setMoveAngle(90);  // à¹„à¸›à¸‚à¸§à¸²
                character.setCurrentCycle("right");
                moving = true;
            } 
            if (keysDown[K_UP]) {
                character.setSpeed(10);
                character.setMoveAngle(0);   // à¸‚à¸¶à¹‰à¸™
                character.setCurrentCycle("up");
                moving = true;
            } 
            if (keysDown[K_DOWN]) {
                character.setSpeed(10);
                character.setMoveAngle(180); // à¸¥à¸‡
                character.setCurrentCycle("down");
                moving = true;
            }

            if (moving) {
                character.playAnimation(); // à¸à¸³à¸¥à¸±à¸‡à¹€à¸”à¸´à¸™à¸­à¸¢à¸¹à¹ˆ à¹€à¸¥à¹ˆà¸™à¹à¸­à¸™à¸´à¹€à¸¡à¸Šà¸±à¸™
            } else {
                character.setSpeed(0);       // à¹„à¸¡à¹ˆà¸à¸”à¸›à¸¸à¹ˆà¸¡à¸­à¸°à¹„à¸£ à¸«à¸¢à¸¸à¸”à¹€à¸”à¸´à¸™
                character.pauseAnimation();  // à¸«à¸¢à¸¸à¸”à¹à¸­à¸™à¸´à¹€à¸¡à¸Šà¸±à¸™
            }
        }
        
        window.onresize = function () {
            let newWidth = window.innerWidth;
            let newHeight = window.innerHeight;
            game.setSize(newWidth, newHeight);

            background.setPosition(newWidth / 2, newHeight / 2);
            // à¹„à¸¡à¹ˆà¸¢à¸¸à¹ˆà¸‡à¸à¸±à¸š character à¸­à¸µà¸à¸•à¹ˆà¸­à¹„à¸›!
        };

    </script>
</head>
<body onload="init()">
</body>
</html>
